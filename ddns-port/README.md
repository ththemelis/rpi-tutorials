# Dynamic DNS και Port Forwarding

Επειδή θέλουμε να έχουμε πρόσβαση στο Raspberry Pi, χρησιμοποιώντας ένα domain name, από οπουδήποτε και όχι μόνο από το εσωτερικό δίκτυο του σχολείου, θα πρέπει πρώτα να ρυθμίσουμε μια υπηρεσία Dynamic DNS και στη συνέχεια να προωθήσουμε τις κατάλληλες πόρτες (port forwarding).

## Dynamic DNS

Στο σχολικό εργαστήριο, διαθέτουμε δυναμική διεύθυνση ΙΡ (εκτός από τα σχολεία που έχουν συνδεθεί στο διαδίκτυο με οπτική ίνα) και για αυτό τον λόγο θα χρησιμοποιήσουμε την Dynamic DNS η οποία είναι μια υπηρεσία η οποία συνδέει ένα domain name με μια δυναμική διεύθυνση ΙΡ. Για τις ανάγκες του οδηγού θα χρησιμοποιήσουμε την ![DuckDNS](https://www.duckdns.org/), η οποία είναι μια από τις πολλές υπηρεσίες δωρεάν DDNS.

1. Αρχικά θα πρέπει να δημιουργήσουμε έναν λογαριασμό στο DuckDNS και στη συνέχεια να δεσμεύσουμε ένα domain name.

<p align="center">
    <img src="images/duckdns.png" alt="DuckDNS" />
</p>

2. Αφού συνδεθούμε στο Raspberry Pi μέσω SSH, θα δημιουργήσουμε έναν φάκελο και μέσα σε αυτόν ένα αρχείο γράφοντας τις παρακάτω εντολές:

```console
mkdir duckdns
cd duckdns
nano duckdns.sh
```

Τώρα, θα επικολλήσουμε την παρακάτω εντολή μέσα στο αρχείο duckdns.sh:

```console
echo url="https://www.duckdns.org/update?domains=[YOUR_DOMAIN]&token=[YOUR_TOKEN]&ip=" | curl -k -o ~/duckdns/duck.log -K -
```

Στην θέση **YOUR_DOMAIN** εισάγουμε το domain name που δεσμεύσαμε και στην θέση **YOUR_TOKEN** εισάγουμε το token.

Αποθηκεύουμε πατώντας **Ctrl+O** και βγαίνουμε από το nano πατώντας **Ctrl+X**.

3. Θα αλλάξουμε τα δικαιώματα χρήσης του αρχείου, έτσι ώστε μόνο εμείς να έχουμε τη δυνατότητα να δούμε τα περιεχόμενά του και να το εκτελέσουμε. Γράφουμε την παρακάτω εντολή:

```console
chmod 700 duckdns.sh
```

4. Τέλος, θα πρέπει να εκτελούμε το αρχείο **duckdns.sh** σε τακτά χρονικά διαστήματα, χρησιμοποιώντας το crontab. Γράφουμε

```console
cronatab -e
```

και στη συνέχεια κάνουμε επικόλληση το

```console
*/5 * * * * ~/duckdns/duckdns.sh >/dev/null 2>&1
```

Αποθηκεύουμε πατώντας **Ctrl+O** και βγαίνουμε από πατώντας **Ctrl+X**.

<p align="center">
    <img src="images/crontab.png" alt="Crontab" />
</p>

Έτσι, θα εκτελείται κάθε 5 λεπτά η εντολή που έχουμε εισάγει μέσα στο αρχείο duckdns.sh και θα ενημερώνεται το domain name με την δυναμική IP που θα έχει ο δρομολογητής μας.

## Port Forward

Ο δρομολογητής - modem του σχολείου διαχειρίζεται τις διευθύνσεις όλων των υπολογιστών του σχολείου, όπως επίσης και του Raspberry Pi. Η διευθύνσεις ΙΡ που εκχωρεί είναι την μορφής 192.168.x.x. Ο στόχος μας 